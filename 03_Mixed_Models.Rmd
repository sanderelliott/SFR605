---
title: "Tutorial 5 - Mixed Models"
author: "SFR605"
output: html_document
---

As we will be reading in data for this lab, let's load a package called here() which allows you to define file paths relative to your current working directory. While we are at it, let's load any other packages that we will need for this activity.
```{r}
library(here) #define file paths relative to current working directory
library(ggplot2) #package for making nice plots, especially of grouped data arranged in long format
library(lme4) #package to run generalized linear mixed models
library(mgcv) #package to run generalized additive mixed models
```


## Case Study: Animal Movement & Occurrence (GLMM)
We are modeling the probability of a bird species being present across 20 different forest fragments. We want to know how forest cover affects presence, while accounting for the fact that each fragment has its own unique characteristics (Random Effect).
```{r}

# Fit Generalized Linear Mixed Model (GLMM)
# Family is binomial because response is 0/1
bird_model <- glmer(presence ~ forest_cover + (1 | fragments), 
                    data = bird_data, 
                    family = binomial)

summary(bird_model)
```

##Case Study: Plant Growth Over Time (GAMM)
We are measuring the growth of a rare orchid over a growing season. The growth is non-linear (slow start, rapid mid-season, leveling off). We have multiple individual plants, and we want to model the non-linear trend while accounting for individual-level variation.
```{r}
# Fit Generalized Additive Mixed Model (GAMM)
# s(days) creates the smooth spline
# s(plants, bs="re") is the way mgcv handles random effects
plant_model <- gam(height ~ s(days) + s(plants, bs = "re"), 
                   data = plant_data, 
                   method = "REML")

# Plot the smooth term (the non-linear trend)
plot(plant_model, select = 1, shade = TRUE, main = "Non-linear Plant Growth")
```


